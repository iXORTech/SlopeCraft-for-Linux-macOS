# How to Complie?

## Libs required:
1. **Qt v6.1.0 or later** for gui
   - later versions may not support windows7
2. **Eigen v3.4.0 or later** for linear algebra
3. [**HeuristicFlow v1.6.2.1**](github.com/ToKiNoBug/HeuristicFlow.git) for mordern optimization algorithms
   - If the repo is not public, draw me an issue to get it.
4. **zlib v1.12.11 or later** for gzip compression

## Projects in SlopeCraft:
|    Project name    | Binary type | Dependents                                    | Description                                              |
| :----------------: | :---------: | :-------------------------------------------- | :------------------------------------------------------- |
|   `imageCutter`    | Executable  | Qt base                                       | A unnecessary image preprocesser                         |
| `BlockListManager` | Static lib  | Qt base, SlopeCraftL's header                 | A class to manage blocks that are avaliable for map arts |
|   `GAConverter`    | Static lib  | Eigen, SlopeCraftL's header, HeuristicFlow    | A converter based on genetic algorithm                   |
|   `SlopeCraftL`    | Shared lib  | Eigen, zlib, GAConverter, HeuristicFlow       | The kernel of SlopeCraft                                 |
|  `SlopeCraftMain`  | Executable  | Qt base, Eigen, SlopeCraftL, BlockListManager | The executable of SlopeCraft                             |

Note that when SlopeCraftL links GAConverter, the link mode is **public**, for GAConverter uses global read-only variables implemented in SlopeCraftL.

## Steps:
1. Install Qt v6.1.0 on your computer. 
   
   It's suggested to install Qt3d together, since they might be called in future version and u won't need to install again if you do that.

   Complier: MingW(gcc). MSVC and clang may not pass the compiling. Your compiler must supports C++ 17 standard.

2. Clone this repo
3. Edit **INCLUDEPATH**
   
   Open *GAConverter.pro*,*SlopeCraftL.pro* and *SlopeCraftMain.pro*, edit the **INCLUDEPATH** variable sothat the headers can get access to libs they need.
   
   For example, on my PC, *Eigen*, *HeuristicFlow* and *Zlib* are placed in a directory named CppLibs, and code below can get access to them:
    ```
            INCLUDEPATH += D:/CppLibs/zlibs \
                           D:/CppLibs/libEigen3\include\eigen3 \
                           D:/\CppLibs/HeuristicFlow-1.6.2.1
    ```
4. Release translation.

5. Build projects `GAConverter`, `SlopeCraftL`, `BlocksListManager` and `imageCutter`.
   
   `SlopeCraftL` is the kernel of SlopeCraft, and it depends on `GAConverter`. `SlopeCraftMain` requires both `SlopeCraftL` and `BlocksListManager`.
6. Copy some files

    If you are building on windows, you don't need to move or copy some files manually. There are copies to be done but they are done automatically when building project `SlopeCraftMain`. Copy commands depends on platforms but I have only Windows, so copy commands on other platforms aren't implemented.
    
    Otherwise you must copy **SlopeCraftL3.dll** generated by project `SlopeCraftL` and folder `blocks` to the same directory where **SlopeCraft.exe** will be generated. The former will be required when linking, while the latter should be found when the executable starts.

7. Build project `SlopeCraftMain` and run the executable.

## Shared lib deployment:
You may need to deploy shared libs for executables. For windows, run `windeployqt SlopeCraft.exe` in command line. And there should be similiar deployment commands on other platforms.

## Notice
1. Since Eigen has many compile-time things, and HeuristicFlow may arouse many stupid warnings, your first compiling may spend several minutes and receive tons of warnings. Just wait and ignore them.
2. If you meet any problem, draw me a new issue.
